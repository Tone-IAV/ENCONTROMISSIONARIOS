<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gestão do Encontro - Visualização Leitura + Edição</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { --p:#1e40af; --s:#3b82f6; --ok:#10b981; --no:#ef4444; --bg:#f8fafc; }
  * { margin:0; padding:0; box-sizing:border-box; font-family:system-ui,sans-serif; }
  body { background:var(--bg); color:#1f2937; line-height:1.6; }
  header { background:var(--p); color:white; padding:2rem; text-align:center; }
  nav { background:#172554; padding:1rem; position:sticky; top:0; z-index:1000; }
  nav ul { display:flex; flex-wrap:wrap; justify-content:center; gap:1rem; list-style:none; }
  nav a { color:white; text-decoration:none; padding:0.8rem 1.4rem; border-radius:8px; font-weight:600; }
  nav a:hover, nav a.active { background:#1e40af; }

  .container { max-width:1400px; margin:0 auto; padding:1.5rem; }
  .view { display:none; }
  .view.active { display:block; }

  .modo-leitura { background:#fff; border-radius:12px; padding:2rem; box-shadow:0 6px 25px rgba(0,0,0,0.1); margin-bottom:2rem; }
  .modo-edicao { display:none; background:#f0f9ff; border:2px dashed #0ea5e9; border-radius:12px; padding:2rem; margin-bottom:2rem; }

  .card { background:white; border-radius:10px; padding:1.5rem; box-shadow:0 4px 15px rgba(0,0,0,0.08); margin-bottom:1rem; }
  .grid-3 { display:grid; gap:1.5rem; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); }

  button { padding:0.8rem 1.4rem; border:none; border-radius:8px; cursor:pointer; font-weight:bold; }
  .btn-editar { background:#f59e0b; color:white; }
  .btn-salvar { background:var(--ok); color:white; }
  .btn-cancelar { background:var(--no); color:white; }
  .btn-no { background:var(--no); color:white; }
  .btn-small { padding:0.4rem 0.8rem; font-size:0.9rem; }

  input, select, textarea { width:100%; padding:0.9rem; border:1px solid #ccc; border-radius:8px; margin:0.5rem 0; font-size:1rem; }
  table { width:100%; border-collapse:collapse; margin:1.5rem 0; }
  th, td { padding:1rem; text-align:left; border-bottom:1px solid #e5e7eb; }
  th { background:#f1f5f9; }

  .kpi { font-size:3.2rem; font-weight:900; color:var(--p); }
  .toggle-modo { position:fixed; top:100px; right:20px; z-index:9999; background:var(--p); color:white; padding:1rem 1.5rem; border-radius:50px; font-weight:bold; box-shadow:0 4px 20px rgba(0,0,0,0.3); }
</style>
</head>
<body>

<header>
  <h1>Gestão do Grande Encontro de Missionários</h1>
  <p>700–1.500 pessoas • Duas visualizações: Leitura e Edição</p>
</header>

<nav>
  <ul>
    <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
    <li><a href="#equipes" class="nav-link">Equipes & Projetos</a></li>
    <li><a href="#participantes" class="nav-link">Participantes</a></li>
    <li><a href="#transporte" class="nav-link">Transporte</a></li>
    <li><a href="#alojamento" class="nav-link">Alojamento</a></li>
    <li><a href="#cronograma" class="nav-link">Cronograma</a></li>
    <li><a href="#cardapio" class="nav-link">Cardápio</a></li>
    <li><a href="#compras" class="nav-link">Compras</a></li>
    <li><a href="#palestras" class="nav-link">Palestras</a></li>
    <li><a href="#kids" class="nav-link">Kids</a></li>
    <li><a href="#financeiro" class="nav-link">Financeiro</a></li>
  </ul>
</nav>

<!-- BOTÃO FLUTUANTE MODO EDIÇÃO -->
<button class="toggle-modo" onclick="toggleModo()">MODO EDIÇÃO</button>

<div class="container">
<main>

<!-- DASHBOARD -->
<section id="dashboard" class="view active">
  <div class="modo-leitura">
    <h2>Dashboard Executivo</h2>
    <div class="grid-3">
      <div class="card"><h3>Participantes</h3><div class="kpi" id="paxTotal">0</div></div>
      <div class="card"><h3>Ônibus</h3><div class="kpi" id="onibusTotal">0</div></div>
      <div class="card"><h3>Voos</h3><div class="kpi" id="voosTotal">0</div></div>
      <div class="card"><h3>Quartos Ocupados</h3><div class="kpi" id="quartosInfo">0 / 0</div></div>
      <div class="card"><h3>Orçado</h3><div class="kpi">R$ <span id="orcado">0,00</span></div></div>
      <div class="card"><h3>Realizado</h3><div class="kpi">R$ <span id="realizado">0,00</span></div></div>
    </div>
  </div>

  <div class="modo-edicao">
    <h2>Editar Dashboard</h2>
    <p>Os dados são atualizados automaticamente com base nos cadastros.</p>
    <button onclick="toggleModo()" class="btn-cancelar">Voltar à Visualização</button>
  </div>
</section>

<!-- EQUIPES E PROJETOS -->
<section id="equipes" class="view">
  <div class="modo-leitura">
    <h2>Equipes, Projetos e Tarefas</h2>
    <div id="equipes-lista"></div>
  </div>
  <div class="modo-edicao">
    <h2>Gerenciar Equipes e Projetos</h2>
    <div class="grid-3">
      <div class="card">
        <h3>Nova Equipe</h3>
        <form id="formEquipe">
          <input type="text" placeholder="Nome da equipe" required>
          <input type="text" placeholder="Responsável" required>
          <textarea placeholder="Membros (separados por vírgula)"></textarea>
          <button type="submit" class="btn-salvar">Salvar Equipe</button>
        </form>
      </div>
      <div class="card">
        <h3>Novo Projeto</h3>
        <form id="formProjeto">
          <input type="text" placeholder="Nome do projeto" required>
          <select id="projetoEquipe" required></select>
          <input type="date" required>
          <select>
            <option value="pendente">Pendente</option>
            <option value="andamento">Em andamento</option>
            <option value="concluido">Concluído</option>
          </select>
          <button type="submit" class="btn-salvar">Salvar Projeto</button>
        </form>
      </div>
      <div class="card">
        <h3>Nova Tarefa (Kanban)</h3>
        <form id="formTarefa">
          <input type="text" placeholder="Título da tarefa" required>
          <select id="tarefaProjeto" required></select>
          <select>
            <option value="backlog">Backlog</option>
            <option value="fazendo">Fazendo</option>
            <option value="pronto">Pronto</option>
          </select>
          <button type="submit" class="btn-salvar">Adicionar Tarefa</button>
        </form>
      </div>
    </div>
    <div id="equipes-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar Edição</button>
  </div>
</section>

<!-- PARTICIPANTES -->
<section id="participantes" class="view">
  <div class="modo-leitura" id="leitura-participantes">
    <h2>Participantes Confirmados</h2>
    <div id="lista-participantes-leitura"></div>
  </div>

  <div class="modo-edicao">
    <h2>Cadastrar Nova Família</h2>
    <form id="formFamilia">
      <input type="text" placeholder="Responsável" required>
      <input type="number" placeholder="Quantas pessoas" min="1" value="1" required>
      <input type="text" placeholder="Cidade/Estado" required>
      <input type="tel" placeholder="WhatsApp">
      <select><option>Ônibus</option><option>Voo</option><option>Carro próprio</option></select>
      <button type="submit" class="btn-salvar">Salvar Família</button>
    </form>
    <div id="lista-participantes-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar Edição</button>
  </div>
</section>

<!-- TRANSPORTE -->
<section id="transporte" class="view">
  <div class="modo-leitura">
    <h2>Transporte Organizado</h2>
    <div id="leitura-transporte"></div>
  </div>
  <div class="modo-edicao">
    <h2>Adicionar Transporte</h2>
    <form id="formOnibus">
      <input type="text" placeholder="Cidade de origem" required>
      <input type="number" placeholder="Passageiros" required>
      <input type="text" placeholder="Empresa/Motorista" required>
      <input type="datetime-local" required>
      <button type="submit" class="btn-salvar">Adicionar Ônibus</button>
    </form>
    <form id="formVoo" style="margin-top:1rem;">
      <input type="text" placeholder="Passageiro" required>
      <input type="text" placeholder="Voo (ex: G3 1234)" required>
      <input type="datetime-local" required>
      <button type="submit" class="btn-salvar">Adicionar Voo</button>
    </form>
    <div id="edicao-transporte"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- ALOJAMENTO -->
<section id="alojamento" class="view">
  <div class="modo-leitura">
    <h2>Alojamentos</h2>
    <div id="leitura-alojamento"></div>
  </div>
  <div class="modo-edicao">
    <h2>Gerenciar Quartos</h2>
    <form id="formQuarto">
      <input type="text" placeholder="Identificação do quarto" required>
      <input type="number" placeholder="Capacidade" min="1" required>
      <button type="submit" class="btn-salvar">Adicionar Quarto</button>
    </form>
    <div id="edicao-alojamento"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- CRONOGRAMA -->
<section id="cronograma" class="view">
  <div class="modo-leitura">
    <h2>Cronograma</h2>
    <div id="cronograma-lista"></div>
  </div>
  <div class="modo-edicao">
    <h2>Adicionar Atividade</h2>
    <form id="formCronograma">
      <input type="datetime-local" required>
      <input type="text" placeholder="Atividade" required>
      <input type="text" placeholder="Responsável" required>
      <button type="submit" class="btn-salvar">Salvar Atividade</button>
    </form>
    <div id="cronograma-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- CARDÁPIO -->
<section id="cardapio" class="view">
  <div class="modo-leitura">
    <h2>Cardápio e Compras Automáticas</h2>
    <div id="cardapio-leitura"></div>
  </div>
  <div class="modo-edicao">
    <h2>Planejar Refeição</h2>
    <form id="formRefeicao">
      <input type="date" required>
      <select>
        <option>Café</option>
        <option>Almoço</option>
        <option>Jantar</option>
      </select>
      <textarea placeholder="Cardápio detalhado" required></textarea>
      <button type="submit" class="btn-salvar">Salvar Refeição</button>
    </form>
    <div id="cardapio-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- COMPRAS -->
<section id="compras" class="view">
  <div class="modo-leitura">
    <h2>Solicitações, Aprovações e Pedidos</h2>
    <div id="compras-leitura"></div>
  </div>
  <div class="modo-edicao">
    <h2>Fluxo de Compras</h2>
    <div class="grid-3">
      <div class="card">
        <h3>Solicitar Compra</h3>
        <form id="formSolicitacao">
          <input type="text" placeholder="Item" required>
          <input type="number" placeholder="Quantidade" min="1" required>
          <input type="text" placeholder="Centro de Custo" required>
          <button type="submit" class="btn-salvar">Nova Solicitação</button>
        </form>
      </div>
      <div class="card">
        <h3>Aprovação Orçamentária</h3>
        <form id="formAprovacao">
          <select id="aprovacaoSolicitacao" required></select>
          <input type="number" placeholder="Valor aprovado" min="0" step="0.01" required>
          <button type="submit" class="btn-salvar">Aprovar</button>
        </form>
      </div>
      <div class="card">
        <h3>Registrar Pedido</h3>
        <form id="formPedido">
          <select id="pedidoAprovado" required></select>
          <input type="text" placeholder="Fornecedor" required>
          <button type="submit" class="btn-salvar">Registrar Pedido</button>
        </form>
      </div>
    </div>
    <div id="compras-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- PALESTRAS -->
<section id="palestras" class="view">
  <div class="modo-leitura">
    <h2>Palestras</h2>
    <div id="palestras-leitura"></div>
  </div>
  <div class="modo-edicao">
    <h2>Programar Palestra</h2>
    <form id="formPalestra">
      <input type="datetime-local" required>
      <input type="text" placeholder="Tema" required>
      <input type="text" placeholder="Palestrante" required>
      <button type="submit" class="btn-salvar">Salvar</button>
    </form>
    <div id="palestras-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- KIDS -->
<section id="kids" class="view">
  <div class="modo-leitura">
    <h2>Programação Kids</h2>
    <div id="kids-leitura"></div>
  </div>
  <div class="modo-edicao">
    <h2>Adicionar Atividade Kids</h2>
    <form id="formKids">
      <input type="datetime-local" required>
      <input type="text" placeholder="Atividade" required>
      <input type="text" placeholder="Responsável" required>
      <button type="submit" class="btn-salvar">Salvar</button>
    </form>
    <div id="kids-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

<!-- FINANCEIRO -->
<section id="financeiro" class="view">
  <div class="modo-leitura">
    <h2>Financeiro</h2>
    <div id="financeiro-leitura"></div>
  </div>
  <div class="modo-edicao">
    <h2>Atualizar Financeiro</h2>
    <div class="grid-3">
      <div class="card">
        <h3>Totais</h3>
        <form id="formFinanceiro">
          <input type="number" placeholder="Orçado" min="0" step="0.01" required>
          <input type="number" placeholder="Realizado" min="0" step="0.01" required>
          <button type="submit" class="btn-salvar">Salvar Totais</button>
        </form>
      </div>
      <div class="card">
        <h3>Novo Centro de Custo</h3>
        <form id="formCentro">
          <input type="text" placeholder="Centro" required>
          <input type="number" placeholder="Orçado" min="0" step="0.01" required>
          <input type="number" placeholder="Realizado" min="0" step="0.01" required>
          <button type="submit" class="btn-salvar">Adicionar Centro</button>
        </form>
      </div>
    </div>
    <div id="financeiro-edicao"></div>
    <button onclick="toggleModo()" class="btn-cancelar">Fechar</button>
  </div>
</section>

</main>
</div>

<script>
// =============================================
// DADOS + PERSISTÊNCIA
// =============================================
const DB = {
  familias: [],
  onibus: [],
  voos: [],
  equipes: [],
  projetos: [],
  tarefas: [],
  quartos: [],
  cronograma: [],
  refeicoes: [],
  solicitacoes: [],
  aprovacoes: [],
  pedidos: [],
  palestras: [],
  kids: [],
  financeiro: { orcado: 0, realizado: 0, centros: [] }
};

function salvar() { localStorage.setItem('encontro2025_duplo', JSON.stringify(DB)); }
function carregar() { Object.assign(DB, JSON.parse(localStorage.getItem('encontro2025_duplo') || '{}')); }
carregar();

// =============================================
// MODO LEITURA / EDIÇÃO GLOBAL
// =============================================
let modoEdicao = false;
function toggleModo() {
  modoEdicao = !modoEdicao;
  document.querySelectorAll('.modo-leitura').forEach(el => el.style.display = modoEdicao ? 'none' : 'block');
  document.querySelectorAll('.modo-edicao').forEach(el => el.style.display = modoEdicao ? 'block' : 'none');
  document.querySelector('.toggle-modo').textContent = modoEdicao ? 'VOLTAR À VISUALIZAÇÃO' : 'MODO EDIÇÃO';
  document.querySelector('.toggle-modo').style.background = modoEdicao ? '#ef4444' : '#1e40af';
  if (modoEdicao) atualizarEdicao();
  else atualizarLeitura();
}

// =============================================
// NAVEGAÇÃO
// =============================================
document.querySelectorAll('.nav-link').forEach(l => {
  l.addEventListener('click', e => {
    e.preventDefault();
    document.querySelectorAll('.nav-link').forEach(x => x.classList.remove('active'));
    l.classList.add('active');
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector(l.getAttribute('href')).classList.add('active');
    modoEdicao ? atualizarEdicao() : atualizarLeitura();
  });
});

// =============================================
// ATUALIZAR TELAS
// =============================================
function formatarDataHora(valor) {
  return new Date(valor).toLocaleString('pt-BR', { dateStyle: 'short', timeStyle: 'short' });
}

function atualizarLeitura() {
  const total = DB.familias.reduce((s, f) => s + f.qtd, 0);
  document.getElementById('paxTotal').textContent = total;
  document.getElementById('onibusTotal').textContent = DB.onibus.length;
  document.getElementById('voosTotal').textContent = DB.voos.length;
  document.getElementById('quartosInfo').innerHTML = `${DB.quartos.length ? DB.quartos.filter(q => q.ocupado).length : 0} / ${DB.quartos.length}`;
  document.getElementById('orcado').textContent = DB.financeiro.orcado.toFixed(2).replace('.', ',');
  document.getElementById('realizado').textContent = DB.financeiro.realizado.toFixed(2).replace('.', ',');

  document.getElementById('lista-participantes-leitura').innerHTML =
    DB.familias.map(f => `<div class="card"><strong>${f.nome}</strong> – ${f.qtd} pessoas – ${f.cidade}</div>`).join('') || '<p>Nenhum participante cadastrado.</p>';

  document.getElementById('equipes-lista').innerHTML = DB.equipes.map(eq => {
    const projetos = DB.projetos.filter(p => p.equipeId === eq.id);
    const tarefas = DB.tarefas.filter(t => projetos.some(p => p.id === t.projetoId));
    return `<div class="card"><strong>${eq.nome}</strong> — Resp.: ${eq.responsavel}<br>Membros: ${eq.membros || '—'}<br>
      <div style="margin-top:0.5rem;"><em>Projetos:</em><ul>${projetos.map(p=>`<li>${p.nome} (${p.status})</li>`).join('') || '<li>Nenhum</li>'}</ul></div>
      <div><em>Tarefas Kanban:</em><ul>${tarefas.map(t=>`<li>[${t.status}] ${t.titulo}</li>`).join('') || '<li>Nenhuma</li>'}</ul></div></div>`;
  }).join('') || '<p>Nenhuma equipe cadastrada.</p>';

  document.getElementById('leitura-transporte').innerHTML = `
    <h3>Ônibus (${DB.onibus.length})</h3>${DB.onibus.map(o => `<div class="card">${o.cidade} – ${o.qtd} pax – ${formatarDataHora(o.data)}</div>`).join('')}
    <h3>Voos (${DB.voos.length})</h3>${DB.voos.map(v => `<div class="card">${v.passageiro} – ${v.voo} – ${formatarDataHora(v.data)}</div>`).join('')}
  `;

  document.getElementById('leitura-alojamento').innerHTML = DB.quartos.map(q => `<div class="card">${q.nome} – Capacidade ${q.capacidade} – ${q.ocupado ? 'Ocupado' : 'Livre'}</div>`).join('') || '<p>Nenhum quarto cadastrado.</p>';

  const eventos = [...DB.cronograma].sort((a, b) => new Date(a.data) - new Date(b.data));
  document.getElementById('cronograma-lista').innerHTML = eventos.map(e => `<div class="card">${formatarDataHora(e.data)} – <strong>${e.titulo}</strong> (${e.responsavel})</div>`).join('') || '<p>Cronograma vazio.</p>';

  document.getElementById('cardapio-leitura').innerHTML = DB.refeicoes.map(r => `<div class="card">${r.tipo} em ${r.data} – ${r.descricao}<br><small>Lista automática: frutas, proteínas, bebidas</small></div>`).join('') || '<p>Nenhuma refeição planejada.</p>';

  document.getElementById('compras-leitura').innerHTML = `
    <h3>Solicitações (${DB.solicitacoes.length})</h3>${DB.solicitacoes.map(s=>`<div class="card">${s.item} – ${s.qtd} un – Centro: ${s.centro}</div>`).join('') || '<p>Sem solicitações.</p>'}
    <h3>Aprovações (${DB.aprovacoes.length})</h3>${DB.aprovacoes.map(a=>`<div class="card">${a.item} – R$ ${a.valor.toFixed(2)} – Aprovado</div>`).join('') || '<p>Sem aprovações.</p>'}
    <h3>Pedidos (${DB.pedidos.length})</h3>${DB.pedidos.map(p=>`<div class="card">${p.item} – Fornecedor: ${p.fornecedor}</div>`).join('') || '<p>Sem pedidos.</p>'}
  `;

  document.getElementById('palestras-leitura').innerHTML = DB.palestras.map(p => `<div class="card">${formatarDataHora(p.data)} – <strong>${p.tema}</strong> com ${p.palestrante}</div>`).join('') || '<p>Nenhuma palestra cadastrada.</p>';

  document.getElementById('kids-leitura').innerHTML = DB.kids.map(k => `<div class="card">${formatarDataHora(k.data)} – ${k.atividade} (Resp.: ${k.responsavel})</div>`).join('') || '<p>Sem atividades kids.</p>';

  const centros = DB.financeiro.centros.map(c => `<li>${c.nome} – Orçado R$ ${c.orcado.toFixed(2)} / Realizado R$ ${c.realizado.toFixed(2)}</li>`).join('') || '<li>Nenhum centro cadastrado.</li>';
  document.getElementById('financeiro-leitura').innerHTML = `
    <div class="card">
      <strong>Orçado:</strong> R$ ${DB.financeiro.orcado.toFixed(2)}<br>
      <strong>Realizado:</strong> R$ ${DB.financeiro.realizado.toFixed(2)}
    </div>
    <div class="card"><h4>Centros de Custo</h4><ul>${centros}</ul></div>
  `;
}

function setSelectOptions(selectId, items, labelFn) {
  const select = document.getElementById(selectId);
  if (!select) return;
  select.innerHTML = '<option value="" disabled selected>Selecione</option>' + items.map(i => `<option value="${i.id}">${labelFn(i)}</option>`).join('');
}

function atualizarEdicao() {
  setSelectOptions('projetoEquipe', DB.equipes, e => e.nome);
  setSelectOptions('tarefaProjeto', DB.projetos, p => p.nome);
  setSelectOptions('aprovacaoSolicitacao', DB.solicitacoes, s => `${s.item} (${s.qtd} un)`);
  setSelectOptions('pedidoAprovado', DB.aprovacoes, a => `${a.item} - R$ ${a.valor.toFixed(2)}`);
  const financeiroForm = document.getElementById('formFinanceiro');
  if (financeiroForm) {
    financeiroForm[0].value = DB.financeiro.orcado;
    financeiroForm[1].value = DB.financeiro.realizado;
  }

  document.getElementById('lista-participantes-edicao').innerHTML =
    DB.familias.map(f => `<div class="card">${f.nome} (${f.qtd} pessoas) <button class="btn-no btn-small" onclick="removerFamilia(${f.id})">Remover</button></div>`).join('');

  document.getElementById('equipes-edicao').innerHTML = DB.equipes.map(eq => `<div class="card">${eq.nome} – Resp.: ${eq.responsavel} <button class="btn-no btn-small" onclick="removerEquipe(${eq.id})">Excluir</button></div>`).join('');

  document.getElementById('edicao-transporte').innerHTML = `
    <h4>Ônibus</h4>${DB.onibus.map(o=>`<div class="card">${o.cidade} (${o.qtd}) <button class="btn-no btn-small" onclick="removerOnibus(${o.id})">Remover</button></div>`).join('')}
    <h4>Voos</h4>${DB.voos.map(v=>`<div class="card">${v.voo} – ${v.passageiro} <button class="btn-no btn-small" onclick="removerVoo(${v.id})">Remover</button></div>`).join('')}
  `;

  document.getElementById('edicao-alojamento').innerHTML = DB.quartos.map(q => `<div class="card">${q.nome} (${q.capacidade}) <button class="btn-no btn-small" onclick="removerQuarto(${q.id})">Remover</button></div>`).join('');

  document.getElementById('cronograma-edicao').innerHTML = DB.cronograma.map(e => `<div class="card">${formatarDataHora(e.data)} – ${e.titulo} <button class="btn-no btn-small" onclick="removerCronograma(${e.id})">Remover</button></div>`).join('');

  document.getElementById('cardapio-edicao').innerHTML = DB.refeicoes.map(r => `<div class="card">${r.tipo} – ${r.data} <button class="btn-no btn-small" onclick="removerRefeicao(${r.id})">Remover</button></div>`).join('');

  document.getElementById('compras-edicao').innerHTML = `
    <h4>Solicitações</h4>${DB.solicitacoes.map(s=>`<div class="card">${s.item} (${s.qtd}) <button class="btn-no btn-small" onclick="removerSolicitacao(${s.id})">Remover</button></div>`).join('')}
    <h4>Aprovações</h4>${DB.aprovacoes.map(a=>`<div class="card">${a.item} – R$ ${a.valor.toFixed(2)} <button class="btn-no btn-small" onclick="removerAprovacao(${a.id})">Remover</button></div>`).join('')}
    <h4>Pedidos</h4>${DB.pedidos.map(p=>`<div class="card">${p.item} – ${p.fornecedor} <button class="btn-no btn-small" onclick="removerPedido(${p.id})">Remover</button></div>`).join('')}
  `;

  document.getElementById('palestras-edicao').innerHTML = DB.palestras.map(p => `<div class="card">${p.tema} <button class="btn-no btn-small" onclick="removerPalestra(${p.id})">Remover</button></div>`).join('');
  document.getElementById('kids-edicao').innerHTML = DB.kids.map(k => `<div class="card">${k.atividade} <button class="btn-no btn-small" onclick="removerKids(${k.id})">Remover</button></div>`).join('');
  document.getElementById('financeiro-edicao').innerHTML = DB.financeiro.centros.map(c => `<div class="card">${c.nome} – R$ ${c.orcado.toFixed(2)} / ${c.realizado.toFixed(2)} <button class="btn-no btn-small" onclick="removerCentro(${c.id})">Remover</button></div>`).join('');
}

// =============================================
// CADASTROS (exemplo participantes e transporte)
// =============================================
document.getElementById('formFamilia').onsubmit = e => {
  e.preventDefault();
  const [nome, qtd, cidade] = [e.target[0].value, +e.target[1].value, e.target[2].value];
  DB.familias.push({ id: Date.now(), nome, qtd, cidade });
  e.target.reset();
  atualizarLeitura(); atualizarEdicao(); salvar();
};

document.getElementById('formEquipe').onsubmit = e => {
  e.preventDefault();
  const [nome, responsavel, membros] = [e.target[0].value, e.target[1].value, e.target[2].value];
  DB.equipes.push({ id: Date.now(), nome, responsavel, membros });
  e.target.reset();
  atualizarLeitura(); atualizarEdicao(); salvar();
};

document.getElementById('formProjeto').onsubmit = e => {
  e.preventDefault();
  const [nome, equipeId, prazo, status] = [e.target[0].value, e.target[1].value, e.target[2].value, e.target[3].value];
  if (!equipeId) return alert('Selecione uma equipe para vincular o projeto.');
  DB.projetos.push({ id: Date.now(), nome, equipeId: Number(equipeId), prazo, status });
  e.target.reset();
  atualizarLeitura(); atualizarEdicao(); salvar();
};

document.getElementById('formTarefa').onsubmit = e => {
  e.preventDefault();
  const [titulo, projetoId, status] = [e.target[0].value, e.target[1].value, e.target[2].value];
  if (!projetoId) return alert('Selecione um projeto para a tarefa.');
  DB.tarefas.push({ id: Date.now(), titulo, projetoId: Number(projetoId), status });
  e.target.reset();
  atualizarLeitura(); atualizarEdicao(); salvar();
};

document.getElementById('formOnibus').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.onibus.push({id:Date.now(), cidade:i[0].value, qtd:+i[1].value, empresa:i[2].value, data:i[3].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formVoo').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.voos.push({id:Date.now(), passageiro:i[0].value, voo:i[1].value, data:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

document.getElementById('formQuarto').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.quartos.push({id:Date.now(), nome:i[0].value, capacidade:+i[1].value, ocupado:false}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

document.getElementById('formCronograma').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.cronograma.push({id:Date.now(), data:i[0].value, titulo:i[1].value, responsavel:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

document.getElementById('formRefeicao').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.refeicoes.push({id:Date.now(), data:i[0].value, tipo:i[1].value, descricao:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

document.getElementById('formSolicitacao').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.solicitacoes.push({id:Date.now(), item:i[0].value, qtd:+i[1].value, centro:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formAprovacao').onsubmit = e => { e.preventDefault(); const i = e.target.elements; if(!i[0].value) return alert('Escolha uma solicitação.'); const solicitacao = DB.solicitacoes.find(s=>s.id===Number(i[0].value)); DB.aprovacoes.push({id:Date.now(), item:solicitacao.item, qtd:solicitacao.qtd, valor:+i[1].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formPedido').onsubmit = e => { e.preventDefault(); const i = e.target.elements; if(!i[0].value) return alert('Escolha uma aprovação.'); const aprovacao = DB.aprovacoes.find(a=>a.id===Number(i[0].value)); DB.pedidos.push({id:Date.now(), item:aprovacao.item, fornecedor:i[1].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

document.getElementById('formPalestra').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.palestras.push({id:Date.now(), data:i[0].value, tema:i[1].value, palestrante:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formKids').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.kids.push({id:Date.now(), data:i[0].value, atividade:i[1].value, responsavel:i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formFinanceiro').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.financeiro.orcado = +i[0].value; DB.financeiro.realizado = +i[1].value; atualizarLeitura(); atualizarEdicao(); salvar(); };
document.getElementById('formCentro').onsubmit = e => { e.preventDefault(); const i = e.target.elements; DB.financeiro.centros.push({id:Date.now(), nome:i[0].value, orcado:+i[1].value, realizado:+i[2].value}); e.target.reset(); atualizarLeitura(); atualizarEdicao(); salvar(); };

window.removerFamilia = id => { DB.familias = DB.familias.filter(f=>f.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerEquipe = id => { DB.equipes = DB.equipes.filter(e=>e.id!==id); DB.projetos = DB.projetos.filter(p=>p.equipeId!==id); DB.tarefas = DB.tarefas.filter(t=>DB.projetos.some(p=>p.id===t.projetoId)); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerOnibus = id => { DB.onibus = DB.onibus.filter(o=>o.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerVoo = id => { DB.voos = DB.voos.filter(v=>v.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerQuarto = id => { DB.quartos = DB.quartos.filter(q=>q.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerCronograma = id => { DB.cronograma = DB.cronograma.filter(c=>c.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerRefeicao = id => { DB.refeicoes = DB.refeicoes.filter(r=>r.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerSolicitacao = id => { DB.solicitacoes = DB.solicitacoes.filter(s=>s.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerAprovacao = id => { DB.aprovacoes = DB.aprovacoes.filter(a=>a.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerPedido = id => { DB.pedidos = DB.pedidos.filter(p=>p.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerPalestra = id => { DB.palestras = DB.palestras.filter(p=>p.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerKids = id => { DB.kids = DB.kids.filter(k=>k.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };
window.removerCentro = id => { DB.financeiro.centros = DB.financeiro.centros.filter(c=>c.id!==id); atualizarLeitura(); atualizarEdicao(); salvar(); };

// =============================================
// INICIALIZAÇÃO
// =============================================
atualizarLeitura();
alert("SISTEMA COM DUAS VISUALIZAÇÕES PRONTO!\n\n• Modo Leitura (padrão)\n• Clique no botão laranja → MODO EDIÇÃO\n\nPerfeito para apresentar e para trabalhar!\n\nDeus abençoe o encontro!");
</script>
</body>
</html>
